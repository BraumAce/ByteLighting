import{_ as a,c as t,a as i,b as n,d as l,o as h}from"./app-BL12ydfr.js";const e={};function p(k,s){return h(),t("div",null,[s[0]||(s[0]=i("h1",{id:"定时任务",tabindex:"-1"},[i("a",{class:"header-anchor",href:"#定时任务"},[i("span",null,"定时任务")])],-1)),n(" more "),s[1]||(s[1]=l(`<h2 id="_1-源码分析" tabindex="-1"><a class="header-anchor" href="#_1-源码分析"><span>1. 源码分析</span></a></h2><p>在实际项目开发中 Web 应用有一类不可缺少的，那就是定时任务。 定时任务的场景可以说非常广泛，比如某些视频网站，购买会员后，每天会给会员送成长值，每月会给会员送一些电影券； 比如在保证最终一致性的场景中，往往利用定时任务调度进行一些比对工作；比如一些定时需要生成的报表、邮件；比如一些需要定时清理数据的任务等。 所以我们提供方便友好的 web 界面，实现动态管理任务，可以达到动态控制定时任务启动、暂停、重启、删除、添加、修改等操作，极大地方便了开发过程。</p><h3 id="_1-1-表结构说明" tabindex="-1"><a class="header-anchor" href="#_1-1-表结构说明"><span>1.1 表结构说明</span></a></h3><p><code>sys_job</code> 表：这是核心的定时任务表，用于存储定时任务的配置信息，如任务名称、任务组、执行的类全名、执行的参数、cron 表达式等</p><p><code>sys_job_log</code> 表：用于记录定时任务的执行日志，包括任务的开始执行时间、结束执行时间、执行结果等</p><figure><img src="https://cloud.braumace.cn/f/eNOf5/1.表结构.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h3 id="_1-2-目录结构" tabindex="-1"><a class="header-anchor" href="#_1-2-目录结构"><span>1.2 目录结构</span></a></h3><p>1）后端代码</p><figure><img src="https://cloud.braumace.cn/f/VDPcN/2.后端代码.png" alt="image-20240817143806315" tabindex="0" loading="lazy"><figcaption>image-20240817143806315</figcaption></figure><ul><li>ScheduleUtils 定时任务工具类</li><li>抽象 quartz 调用类 AbstractQuartzJob（实现Job接口）</li><li>定时任务处理类（禁止并发执行） 继承抽象类</li><li>定时任务处理类（允许并发执行） 继承抽象类</li><li>任务执行工具类 JobInvokeUtil</li><li>cron 表达式工具类</li></ul><p>2）前端代码</p><figure><img src="https://cloud.braumace.cn/f/mk5c1/3.前端代码.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h3 id="_1-3-quartz-体系结构" tabindex="-1"><a class="header-anchor" href="#_1-3-quartz-体系结构"><span>1.3 Quartz 体系结构</span></a></h3><figure><img src="https://cloud.braumace.cn/f/YlKc8/4.Quartz体系结构.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h3 id="_1-4-quartz-核心-api" tabindex="-1"><a class="header-anchor" href="#_1-4-quartz-核心-api"><span>1.4 Quartz 核心 API</span></a></h3><table><thead><tr><th>API</th><th>描述</th></tr></thead><tbody><tr><td><strong>Job</strong></td><td>- 实际要执行的任务类<br>- 必须实现Quartz的<code>Job</code>接口。</td></tr><tr><td><strong>JobDetail</strong></td><td>- 代表一个<code>Job</code>实例<br>- 通过<code>JobBuilder</code>类创建。</td></tr><tr><td><strong>JobBuilder</strong></td><td>- 用于声明一个任务实例<br>- 可以定义关于该任务的详情，如任务名、组名等。</td></tr><tr><td><strong>Trigger</strong></td><td>- 触发器，用来触发并执行<code>Job</code>实例的机制。</td></tr><tr><td><strong>SimpleTrigger</strong></td><td>- 用于简单重复执行作业的触发器<br>- 例如：每隔一定时间执行一次。</td></tr><tr><td><strong>CronTrigger</strong></td><td>- 使用Cron表达式定义执行计划的触发器<br>- 适用于定义复杂的执行时间。</td></tr><tr><td><strong>TriggerBuilder</strong></td><td>- 用于创建触发器<code>Trigger</code>实例的构建器。</td></tr><tr><td><strong>Scheduler</strong></td><td>- Quartz中的核心组件<br>- 负责启动、停止、暂停和恢复任务。</td></tr></tbody></table><h3 id="_1-5-定时任务执行" tabindex="-1"><a class="header-anchor" href="#_1-5-定时任务执行"><span>1.5 定时任务执行</span></a></h3><p>项目在启动时，初始化定时任务</p><figure><img src="https://cloud.braumace.cn/f/a35Uo/5.初始化定时任务.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>流程图：</p><figure><img src="https://cloud.braumace.cn/f/67PTw/6.定时任务流程图.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h3 id="_1-6-添加定时任务" tabindex="-1"><a class="header-anchor" href="#_1-6-添加定时任务"><span>1.6 添加定时任务</span></a></h3><p>在项目启动时，从数据库中查询任务配置列表，然后创建定时任务，并根据状态判断是否执行任务调度，那如果是新添加的定时任务该如何处理呢？为了解答这个问题，我们来对这部分的源码进行分析。</p><p>重点关注后端部分，入口在定时任务模块的 sysJobController 中：</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">/**</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> * 修改定时任务</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> */</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">@</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B;">PreAuthorize</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;@ss.hasPermi(&#39;monitor:job:edit&#39;)&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">@</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B;">Log</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">title</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;定时任务&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> businessType</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> BusinessType</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">UPDATE</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">@</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B;">PutMapping</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">public</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> AjaxResult</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> edit</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">@</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B;">RequestBody</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> SysJob</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> job) throws SchedulerException</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> TaskException</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">{</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    if</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> (</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">!</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">CronUtils</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">isValid</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">job</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">getCronExpression</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">())</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">    {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        return</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> error</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;修改任务&#39;&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> +</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> job</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">getJobName</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> +</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;&#39;失败，Cron表达式不正确&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">    }</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    else</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> if</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> (</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">StringUtils</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">containsIgnoreCase</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">job</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">getInvokeTarget</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(), </span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">Constants</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">LOOKUP_RMI</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">    {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        return</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> error</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;修改任务&#39;&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> +</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> job</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">getJobName</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> +</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;&#39;失败，目标字符串不允许&#39;rmi&#39;调用&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">    }</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    else</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> if</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> (</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">StringUtils</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">containsAnyIgnoreCase</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">job</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">getInvokeTarget</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(), </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">new</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> String</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[] { </span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">Constants</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">LOOKUP_LDAP</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">Constants</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">LOOKUP_LDAPS</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> })</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">    {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        return</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> error</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;修改任务&#39;&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> +</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> job</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">getJobName</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> +</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;&#39;失败，目标字符串不允许&#39;ldap(s)&#39;调用&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">    }</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    else</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> if</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> (</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">StringUtils</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">containsAnyIgnoreCase</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">job</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">getInvokeTarget</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(), </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">new</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> String</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[] { </span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">Constants</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">HTTP</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">Constants</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">HTTPS</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> })</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">    {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        return</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> error</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;修改任务&#39;&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> +</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> job</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">getJobName</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> +</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;&#39;失败，目标字符串不允许&#39;http(s)&#39;调用&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">    }</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    else</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> if</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> (</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">StringUtils</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">containsAnyIgnoreCase</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">job</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">getInvokeTarget</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(), </span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">Constants</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">JOB_ERROR_STR</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">    {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        return</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> error</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;修改任务&#39;&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> +</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> job</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">getJobName</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> +</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;&#39;失败，目标字符串存在违规&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">    }</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    else</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> if</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> (</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">!</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">ScheduleUtils</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">whiteList</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">job</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">getInvokeTarget</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">())</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">    {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        return</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> error</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;修改任务&#39;&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> +</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> job</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">getJobName</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> +</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;&#39;失败，目标字符串不在白名单内&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">    }</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">    job</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">setUpdateBy</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">getUsername</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">());</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    return</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> toAjax</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">jobService</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">updateJob</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(job)</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>代码流程图：</p><figure><img src="https://cloud.braumace.cn/f/zPAsy/7.新增定时任务.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h3 id="_1-7-定时任务状态修改" tabindex="-1"><a class="header-anchor" href="#_1-7-定时任务状态修改"><span>1.7 定时任务状态修改</span></a></h3><p>通过分析新增定时任务的源码，可以发现，任务在初始化时是处于暂停状态的。</p><p>如果要启动任务，可以在页面进行任务状态的开关控制，所以接下来对此功能的源码进行分析。</p><p>入口在定时任务模块的 sysJobController 中：</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">/**</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> * 定时任务状态修改</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> */</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">@</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B;">PreAuthorize</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;@ss.hasPermi(&#39;monitor:job:changeStatus&#39;)&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">@</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B;">Log</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">title</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;定时任务&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> businessType</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> BusinessType</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">UPDATE</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">@</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B;">PutMapping</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;/changeStatus&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">)</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">public</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> AjaxResult</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> changeStatus</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">@</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B;">RequestBody</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> SysJob</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> job) throws </span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">SchedulerException</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">{</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    // 根据任务ID查询数据库，获取当前任务的配置信息</span></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">    SysJob</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> newJob </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> jobService</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">selectJobById</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">job</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">getJobId</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">());</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    // 将前端的状态设置到任务配置对象中</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">    newJob</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">setStatus</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">job</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">getStatus</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">());</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    // 调用服务层的方法根据状态启动/暂停任务，并返回操作结果</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    return</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> toAjax</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">jobService</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">changeStatus</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(newJob)</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>代码流程图：</p><figure><img src="https://cloud.braumace.cn/f/gYdt1/8.修改定时任务状态.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h2 id="_2-集群模式" tabindex="-1"><a class="header-anchor" href="#_2-集群模式"><span>2. 集群模式</span></a></h2><h3 id="_2-1-集群介绍" tabindex="-1"><a class="header-anchor" href="#_2-1-集群介绍"><span>2.1 集群介绍</span></a></h3><p>为什么需要 Quartz 集群？</p><p>在单机模式下，默认所有的 <code>jobDetail</code> 和 <code>trigger</code> 都存储在内存中。这样做的好处是读取速度快，但缺点也很明显：一旦服务器故障，所有的任务数据就会丢失，这就是所谓的单点故障问题。</p><p>还有如果在一个高峰时段，比如上午 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>9</mn></mrow><annotation encoding="application/x-tex">9</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">9</span></span></span></span> 点，需要触发 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>500</mn></mrow><annotation encoding="application/x-tex">500</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">500</span></span></span></span> 个任务，这将给服务器带来巨大的负载压力。这不仅影响性能，还可能引发服务中断。</p><p>缺点：单点故障、负载压力大</p><p>为了解决这些问题，我们可以部署多个服务器节点，将任务信息存储到数据库中。这样，多个节点就可以通过共享数据库来协调任务的执行，形成 Quartz 集群模式。</p><p>这种方式不仅解决了单点故障问题，还能通过负载均衡提升效率。</p><p>集群模式的优势：</p><ul><li><strong>高可用性</strong>：即使某个节点出现问题，其他节点仍然可以正常运行。</li><li><strong>负载均衡</strong>：将任务分散到不同的节点执行，避免单个节点过载。</li></ul><p>通常在生产环境中，我们会部署多台服务器，所以采用集群模式不会产生额外的成本。</p><figure><img src="https://cloud.braumace.cn/f/BmVtB/9.集群模式.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p><strong>quartz集群所需数据库表：</strong></p><table><thead><tr><th>表名</th><th>用途</th></tr></thead><tbody><tr><td><code>qrtz_triggers</code></td><td>存储触发器的基本信息，如触发器名称、组、类型等。</td></tr><tr><td><code>qrtz_cron_triggers</code></td><td>存储Cron触发器的额外信息，如Cron表达式。</td></tr><tr><td><code>qrtz_simple_triggers</code></td><td>存储简单触发器的额外信息，如重复次数和间隔。</td></tr><tr><td><code>qrtz_blob_triggers</code></td><td>存储BLOB类型触发器的额外信息，如持久化的数据。</td></tr><tr><td><code>qrtz_simprop_triggers</code></td><td>存储具有单一触发器属性的触发器的详细信息。</td></tr><tr><td><code>qrtz_job_details</code></td><td>存储作业详细信息，如作业名称、组、描述、作业类名等。</td></tr><tr><td><code>qrtz_scheduler_state</code></td><td>存储调度器的状态信息，如当前主节点信息等。</td></tr><tr><td><code>qrtz_locks</code></td><td>存储锁信息，用于控制并发和防止资源冲突。</td></tr><tr><td><code>qrtz_paused_trigger_grps</code></td><td>存储被暂停的触发器组的信息。</td></tr><tr><td><code>qrtz_fired_triggers</code></td><td>存储已触发的触发器的详细信息，包括执行历史。</td></tr><tr><td><code>qrtz_calendars</code></td><td>存储日历信息，定义工作日和非工作日，用于调度时间约束。</td></tr></tbody></table><h3 id="_2-2-实现" tabindex="-1"><a class="header-anchor" href="#_2-2-实现"><span>2.2 实现</span></a></h3><h4 id="_2-2-1-导入sql" tabindex="-1"><a class="header-anchor" href="#_2-2-1-导入sql"><span>2.2.1 导入sql</span></a></h4><p>将 ruoyi 提供的 <code>quartz.sql</code> 导入到数据库中：</p><figure><img src="https://cloud.braumace.cn/f/JVjHo/10.导入sql.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h4 id="_2-2-2-开启配置" tabindex="-1"><a class="header-anchor" href="#_2-2-2-开启配置"><span>2.2.2 开启配置</span></a></h4><p>打开 <code>dkd-quartz</code> 模块中 <code>ScheduleConfig</code> 配置类注释：</p><figure><img src="https://cloud.braumace.cn/f/0djuB/11.开启配置.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h4 id="_2-2-3-节点复制" tabindex="-1"><a class="header-anchor" href="#_2-2-3-节点复制"><span>2.2.3 节点复制</span></a></h4><p>首先修改当前 SpringBoot 的启动类的名称</p><figure><img src="https://cloud.braumace.cn/f/P13t0/12.1 修改启动类1.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><figure><img src="https://cloud.braumace.cn/f/QZLso/12.2 修改启动类2.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>再添加（复制）一个 SpringBoot 的启动配置</p><p><code>-Dserver.port=8081</code></p><figure><img src="https://cloud.braumace.cn/f/oJXH2/12.3 修改启动类3.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h4 id="_2-2-4-观察数据库" tabindex="-1"><a class="header-anchor" href="#_2-2-4-观察数据库"><span>2.2.4 观察数据库</span></a></h4><p>重启项目即可，观察数据库，已存入 <code>jobDetail</code> 和 <code>trigger</code>，多个服务器节点可以实现共享。</p><figure><img src="https://cloud.braumace.cn/f/nOjUz/13.1 观察数据库1.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><figure><img src="https://cloud.braumace.cn/f/dVRt0/13.2 观察数据库2.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure>`,66))])}const d=a(e,[["render",p],["__file","定时任务.html.vue"]]),g=JSON.parse('{"path":"/framework/ruoyi/%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1.html","title":"定时任务","lang":"zh-CN","frontmatter":{"category":["常用框架"],"tag":["RuoYi"],"head":[["meta",{"property":"og:url","content":"https://blog.braumace.cn/ByteLighting/framework/ruoyi/%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1.html"}],["meta",{"property":"og:site_name","content":"ByteLighting"}],["meta",{"property":"og:title","content":"定时任务"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://cloud.braumace.cn/f/eNOf5/1.%E8%A1%A8%E7%BB%93%E6%9E%84.png"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-10-05T12:57:18.000Z"}],["meta",{"property":"article:tag","content":"RuoYi"}],["meta",{"property":"article:modified_time","content":"2024-10-05T12:57:18.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"定时任务\\",\\"image\\":[\\"https://cloud.braumace.cn/f/eNOf5/1.%E8%A1%A8%E7%BB%93%E6%9E%84.png\\",\\"https://cloud.braumace.cn/f/VDPcN/2.%E5%90%8E%E7%AB%AF%E4%BB%A3%E7%A0%81.png\\",\\"https://cloud.braumace.cn/f/mk5c1/3.%E5%89%8D%E7%AB%AF%E4%BB%A3%E7%A0%81.png\\",\\"https://cloud.braumace.cn/f/YlKc8/4.Quartz%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84.png\\",\\"https://cloud.braumace.cn/f/a35Uo/5.%E5%88%9D%E5%A7%8B%E5%8C%96%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1.png\\",\\"https://cloud.braumace.cn/f/67PTw/6.%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1%E6%B5%81%E7%A8%8B%E5%9B%BE.png\\",\\"https://cloud.braumace.cn/f/zPAsy/7.%E6%96%B0%E5%A2%9E%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1.png\\",\\"https://cloud.braumace.cn/f/gYdt1/8.%E4%BF%AE%E6%94%B9%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1%E7%8A%B6%E6%80%81.png\\",\\"https://cloud.braumace.cn/f/BmVtB/9.%E9%9B%86%E7%BE%A4%E6%A8%A1%E5%BC%8F.png\\",\\"https://cloud.braumace.cn/f/JVjHo/10.%E5%AF%BC%E5%85%A5sql.png\\",\\"https://cloud.braumace.cn/f/0djuB/11.%E5%BC%80%E5%90%AF%E9%85%8D%E7%BD%AE.png\\",\\"https://cloud.braumace.cn/f/P13t0/12.1%20%E4%BF%AE%E6%94%B9%E5%90%AF%E5%8A%A8%E7%B1%BB1.png\\",\\"https://cloud.braumace.cn/f/QZLso/12.2%20%E4%BF%AE%E6%94%B9%E5%90%AF%E5%8A%A8%E7%B1%BB2.png\\",\\"https://cloud.braumace.cn/f/oJXH2/12.3%20%E4%BF%AE%E6%94%B9%E5%90%AF%E5%8A%A8%E7%B1%BB3.png\\",\\"https://cloud.braumace.cn/f/nOjUz/13.1%20%E8%A7%82%E5%AF%9F%E6%95%B0%E6%8D%AE%E5%BA%931.png\\",\\"https://cloud.braumace.cn/f/dVRt0/13.2%20%E8%A7%82%E5%AF%9F%E6%95%B0%E6%8D%AE%E5%BA%932.png\\"],\\"dateModified\\":\\"2024-10-05T12:57:18.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"BraumAce\\",\\"url\\":\\"https://blog.braumace.cn/article\\"}]}"]]},"headers":[{"level":2,"title":"1. 源码分析","slug":"_1-源码分析","link":"#_1-源码分析","children":[{"level":3,"title":"1.1 表结构说明","slug":"_1-1-表结构说明","link":"#_1-1-表结构说明","children":[]},{"level":3,"title":"1.2 目录结构","slug":"_1-2-目录结构","link":"#_1-2-目录结构","children":[]},{"level":3,"title":"1.3 Quartz 体系结构","slug":"_1-3-quartz-体系结构","link":"#_1-3-quartz-体系结构","children":[]},{"level":3,"title":"1.4 Quartz 核心 API","slug":"_1-4-quartz-核心-api","link":"#_1-4-quartz-核心-api","children":[]},{"level":3,"title":"1.5 定时任务执行","slug":"_1-5-定时任务执行","link":"#_1-5-定时任务执行","children":[]},{"level":3,"title":"1.6 添加定时任务","slug":"_1-6-添加定时任务","link":"#_1-6-添加定时任务","children":[]},{"level":3,"title":"1.7 定时任务状态修改","slug":"_1-7-定时任务状态修改","link":"#_1-7-定时任务状态修改","children":[]}]},{"level":2,"title":"2. 集群模式","slug":"_2-集群模式","link":"#_2-集群模式","children":[{"level":3,"title":"2.1 集群介绍","slug":"_2-1-集群介绍","link":"#_2-1-集群介绍","children":[]},{"level":3,"title":"2.2 实现","slug":"_2-2-实现","link":"#_2-2-实现","children":[{"level":4,"title":"2.2.1 导入sql","slug":"_2-2-1-导入sql","link":"#_2-2-1-导入sql","children":[]},{"level":4,"title":"2.2.2 开启配置","slug":"_2-2-2-开启配置","link":"#_2-2-2-开启配置","children":[]},{"level":4,"title":"2.2.3 节点复制","slug":"_2-2-3-节点复制","link":"#_2-2-3-节点复制","children":[]},{"level":4,"title":"2.2.4 观察数据库","slug":"_2-2-4-观察数据库","link":"#_2-2-4-观察数据库","children":[]}]}]}],"git":{"createdTime":1727609770000,"updatedTime":1728133038000,"contributors":[{"name":"BraumAce","email":"1693717911@qq.com","commits":2}]},"readingTime":{"minutes":6.9,"words":2070},"filePathRelative":"framework/ruoyi/定时任务.md","localizedDate":"2024年9月29日","excerpt":"\\n"}');export{d as comp,g as data};
